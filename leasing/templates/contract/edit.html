{% extends 'base.html'%}

{% block title %}

{% endblock %}

{% block content %}
    <div class="container my-5">
        <h1 class="mb-4">{% if is_new %}Добавить контракт{% else %}Изменить контракт{% endif %}</h1>

        <form method="post" enctype="multipart/form-data" class="row g-3">
            {% csrf_token %}

            <!-- Contract Form Section -->
            <div class="col-md-6">
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5>Детали контракта</h5>
                    </div>
                    <div class="card-body">
                        {{ contract_form.non_field_errors }}
                        <div class="mb-3">
                            <label for="{{ contract_form.number.id_for_label }}" class="form-label">Номер контракта</label>
                            {{ contract_form.number }}
                            <small class="text-danger">{{ contract_form.number.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ contract_form.lessee.id_for_label }}" class="form-label">Лизингополучатель</label>
                            {{ contract_form.lessee }}
                            <small class="text-danger">{{ contract_form.lessee.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ contract_form.seller.id_for_label }}" class="form-label">Продавец</label>
                            {{ contract_form.seller }}
                            <small class="text-danger">{{ contract_form.seller.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ contract_form.meter.id_for_label }}" class="form-label">Прибор учета</label>
                            {{ contract_form.meter }}
                            <small class="text-danger">{{ contract_form.meter.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ contract_form.started.id_for_label }}" class="form-label">Дата начала действия</label>
                            {{ contract_form.started }}
                            <small class="text-danger">{{ contract_form.started.errors }}</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Finance Details Section -->
            <div class="col-md-6">
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-success text-white">
                        <h5>Финансовые детали</h5>
                    </div>
                    <div class="card-body">
                        {{ finance_details_form.non_field_errors }}
                        <div class="mb-3">
                            <label for="{{ finance_details_form.cost.id_for_label }}" class="form-label">Стоимость</label>
                            {{ finance_details_form.cost }}
                            <small class="text-danger">{{ finance_details_form.cost.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ finance_details_form.upfront.id_for_label }}" class="form-label">Авансовый платеж</label>
                            {{ finance_details_form.upfront }}
                            <small class="text-danger">{{ finance_details_form.upfront.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ finance_details_form.final_payment.id_for_label }}" class="form-label">Финальный платеж</label>
                            {{ finance_details_form.final_payment }}
                            <small class="text-danger">{{ finance_details_form.final_payment.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ finance_details_form.period.id_for_label }}" class="form-label">Срок (месяцы)</label>
                            {{ finance_details_form.period }}
                            <small class="text-danger">{{ finance_details_form.period.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ finance_details_form.rate.id_for_label }}" class="form-label">Процентная ставка (%)</label>
                            {{ finance_details_form.rate }}
                            <small class="text-danger">{{ finance_details_form.rate.errors }}</small>
                        </div>
                        <div class="mb-3">
                            <label for="{{ finance_details_form.vat_rate.id_for_label }}" class="form-label">Ставка НДС (%)</label>
                            {{ finance_details_form.vat_rate }}
                            <small class="text-danger">{{ finance_details_form.vat_rate.errors }}</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="col-12 d-flex justify-content-end gap-2">
                <a href="{% url 'list_contract' %}" class="btn btn-secondary">Отменить</a>
                <button type="submit" class="btn btn-primary">Сохранить</button>
            </div>
        </form>
    </div>
{% endblock %}